---
import NumberInput from '../components/NumberInput.astro';
import Button from '../components/Button.astro';
import '../styles/styles.css';
---

<head>
  <title>Add/Sub Setup</title>
</head>

<body>
  <div class="form-container">
    <h1 id="title">Add/Sub</h1>

    <div class="input-row">
      <span class="input-label"># of digits (1-6)</span>
      <NumberInput
        id="digitsInput"
        placeholder="Enter digits"
        size="lg"
        minValue={1}
        maxValue={6}
        allowDecimals={false}
      />
    </div>

    <div class="input-row">
      <span class="input-label"># of numbers (1-6)</span>
      <NumberInput
        id="numbersInput"
        placeholder="Enter number of terms"
        size="lg"
        minValue={1}
        maxValue={6}
      />
    </div>

    <div class="input-row">
      <span class="input-label">Speed (0.02-3)</span>
      <NumberInput
        id="speedInput"
        placeholder="Enter speed"
        size="lg"
        minValue={0.02}
        maxValue={3}
        allowDecimals={true}
      />
    </div>

    <Button
      id="backButton"
      size="lg"
      backgroundColor="#4ea7f5"
      textColor="white"
      borderColor="transparent"
      href="/"
    >
      Back
    </Button>

    <!-- We'll handle client-side navigation for Next -->
    <Button
      id="nextButton"
      size="lg"
      backgroundColor="#4ea7f5"
      textColor="white"
      borderColor="transparent"
    >
      Next
    </Button>
  </div>

  <script type="module">
    const nextBtn = document.querySelector('#nextButton');
    const digitsInput = document.querySelector('#digitsInput');
    const numbersInput = document.querySelector('#numbersInput');
    const speedInput = document.querySelector('#speedInput');

    nextBtn?.addEventListener('click', () => {
      if (!digitsInput || !numbersInput || !speedInput) {
        alert('Inputs not found in the DOM.');
        return;
      }

      const digitsVal = digitsInput.value;
      const numbersVal = numbersInput.value;
      const speedVal = speedInput.value;

      if (!digitsVal || !numbersVal || !speedVal) {
        alert('Please fill in all fields.');
        return;
      }

      // Build the URL to /flash with query params
      const url = new URL('/flash', window.location.origin);
      url.searchParams.set('digits', digitsVal);
      url.searchParams.set('numbers', numbersVal);
      url.searchParams.set('speed', speedVal);

      // Navigate
      window.location.href = url.toString();
    });
  </script>
</body>
